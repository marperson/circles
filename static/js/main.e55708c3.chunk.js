(this.webpackJsonpcircles=this.webpackJsonpcircles||[]).push([[0],{41:function(e,i,t){e.exports=t(52)},46:function(e,i,t){},51:function(e,i,t){},52:function(e,i,t){"use strict";t.r(i);var n=t(0),a=t.n(n),o=t(13),s=t.n(o),r=t(84),l=t(83),h=t(38),c=t(78),d=t(86),u=t(79),v=t(75),p=t(85),g=t(80),f=t(81),m=t(82),y=t(8),w=t(9),b=t(17),k=t(15),x=(t(46),function(){function e(){Object(y.a)(this,e),this.imageCache=new Map,this.loadsCompleted=0,this.nLoads=0,this.loadCallback=void 0}return Object(w.a)(e,[{key:"registerCallback",value:function(e){this.loadsCompleted===this.nLoads&&e(),this.loadCallback=e}},{key:"getImageFromCache",value:function(e){var i=this.imageCache.get(e);if(this.nLoads++,!i)throw Error("unable to load image: "+e);return i}},{key:"preLoadImage",value:function(e,i){var t=this,n=new Image;this.nLoads++,n.src=i,n.onload=function(){t.imageCache.set(e,n),++t.loadsCompleted===t.nLoads&&t.loadCallback&&t.loadCallback()}}}]),e}()),z=t(77),C=function(e){Object(b.a)(t,e);var i=Object(k.a)(t);function t(e){var n;return Object(y.a)(this,t),(n=i.call(this,e)).debug=!1,n.keysPressed=new Map,n.imagePreloader=void 0,n.state=void 0,n._scene=void 0,n.canvasRef=a.a.createRef(),n.imagePreloader=new x,n.preloadImagesKeyPathMap&&n.preloadImagesKeyPathMap().forEach((function(e,i){return n.imagePreloader.preLoadImage(i,e)})),n.state={imagesLoaded:!1},n}return Object(w.a)(t,[{key:"transition",value:function(e,i){var t=this;e.addBehavior({handleKill:function(){t.scene=i}}),this.scene!==e&&(this.scene=e)}},{key:"componentDidMount",value:function(){var e=this;this.imagePreloader.registerCallback((function(){e.handleImagesLoaded()}))}},{key:"handleImagesLoaded",value:function(){var e=this.canvasRef.current,i=e.getContext("2d"),t=this,n=e.width,a=e.height;document.addEventListener("keydown",(function(e){t.keysPressed.set(e.key,!0)})),document.addEventListener("keyup",(function(e){t.keysPressed.delete(e.key)})),e.addEventListener("mousedown",(function(i){var n=e.getBoundingClientRect();t.scene.handleMouseClick(i.clientX-n.left,i.clientY-n.top)})),document.addEventListener("touchmove",(function(i){var n=e.getBoundingClientRect(),a=i.targetTouches[0];t.scene.handleMouseClick(a.clientX-n.left,a.clientY-n.top)}),!1);var o=0;this.resizeCanvas(),this.init(),requestAnimationFrame((function e(s){var r=o?s-o:0;o=s,r>100&&(r=0),n===window.innerWidth&&a===window.innerHeight||t.resizeCanvas(),t.keysPressed.forEach((function(e,i){return t.scene.handleKeyPressed(i)})),i.save(),t.paintBackground(i),t.scene.paint({x:0,y:0},i,r),t.scene.updateModel(r),i.restore(),requestAnimationFrame(e)})),this.setState({imagesLoaded:!0})}},{key:"resizeCanvas",value:function(){var e=this.canvasRef.current;e.width=window.innerWidth,e.height=window.innerHeight;var i={width:e.width,height:e.height};this.scene&&(this.scene.size=i)}},{key:"paintBackground",value:function(e){e.fillStyle="white",e.fillRect(0,0,this.scene.size.width,this.scene.size.height)}},{key:"updateModel",value:function(e){this.scene.updateModel(e)}},{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,!this.state.imagesLoaded&&a.a.createElement(a.a.Fragment,null,a.a.createElement(v.a,{variant:"h2",gutterBottom:!0},"Loading images..."),a.a.createElement(z.a,null)),a.a.createElement("canvas",{id:"Canvas",ref:this.canvasRef}))}},{key:"scene",set:function(e){this.debug&&console.log("SetScene: ".concat(e.constructor.name)),e.debug=this.debug;var i=this.canvasRef.current;e.size={width:i.width,height:i.height},this._scene=e},get:function(){return this._scene}}]),t}(a.a.Component),S=t(36),M=t(28),E=t(10),O=function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:0,height:0};Object(y.a)(this,e),this.position=void 0,this.size=void 0,this.isAlive=!0,this.speed=0,this.angle=0,this.acceleration=0,this.canCollide=!1,this.isFixedPosition=!1,this.behaviors=[],this.position=i,this.size=t}return Object(w.a)(e,[{key:"addBehavior",value:function(e){e.init&&e.init(this),this.behaviors.push(e)}},{key:"paint",value:function(e,i,t){var n=this;this.behaviors.forEach((function(a){var o;return null===(o=a.paint)||void 0===o?void 0:o.call(a,n,e,i,t)}))}},{key:"updateModel",value:function(e){var i=this;this.behaviors.forEach((function(t){var n;return null===(n=t.updateModel)||void 0===n?void 0:n.call(t,i,e)}))}},{key:"handleKill",value:function(){var e=this;this.behaviors.forEach((function(i){var t;return null===(t=i.handleKill)||void 0===t?void 0:t.call(i,e)}))}},{key:"handleCollision",value:function(e){var i=this;this.behaviors.forEach((function(t){var n;return null===(n=t.handleCollision)||void 0===n?void 0:n.call(t,i,e)}))}}]),e}();function P(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function j(e){return e.speed&&e.angle?{x:e.speed*Math.cos(e.angle),y:e.speed*Math.sin(e.angle)}:{x:0,y:0}}function L(e,i){var t=e.size.width,n=e.size.height;if((t|n)<0)return i;var a=i.size.width,o=i.size.height;if((a|o)<0)return e;var s=e.position.x,r=e.position.y;t+=s,n+=r;var l=i.position.x,h=i.position.y;return s>l&&(s=l),r>h&&(r=h),t<(a+=l)&&(t=a),n<(o+=h)&&(n=o),{position:{x:s,y:r},size:{width:t-=s,height:n-=r}}}function A(e,i){var t=e.size.width,n=e.size.height,a=i.size.width,o=i.size.height;if(a<=0||o<=0||t<=0||n<=0)return!1;var s=e.position.x,r=e.position.y,l=i.position.x,h=i.position.y;return o+=h,t+=s,n+=r,((a+=l)<l||a>s)&&(o<h||o>r)&&(t<s||t>l)&&(n<r||n>h)}function B(e,i){var t=e.indexOf(i,0);t>-1&&e.splice(t,1)}var R=function(e){Object(b.a)(t,e);var i=Object(k.a)(t);function t(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:0,height:0};return Object(y.a)(this,t),(n=i.call(this)).viewPort={x:0,y:0},n.gameCanvas=void 0,n.debug=!1,n.collisionListeners=[],n.sprites=[],n.wrapAround=!1,n.sceneSpeed=1,n.modelSize=void 0,n.count=0,n.totalTime=0,n.gameCanvas=e,n.modelSize=a,n}return Object(w.a)(t,[{key:"handleKeyPressed",value:function(e){}},{key:"handleMouseClick",value:function(e,i){}},{key:"getSpritesAtPoint",value:function(e){return this.sprites.filter((function(i){return function(e,i){return e.x>=i.position.x&&e.x<i.position.x+i.size.width&&e.y>=i.position.y&&e.y<i.position.y+i.size.height}(e,i)}))}},{key:"addSprite",value:function(e){this.debug&&console.log("AddSprite: "+e),this.sprites.push(e),e.priorPosition=e.position,e.handleCollision&&this.collisionListeners.push(e)}},{key:"removeSprite",value:function(e){var i;null===(i=e.handleKill)||void 0===i||i.call(e),this.debug&&console.log("RemoveSprite: "+e),B(this.sprites,e),B(this.collisionListeners,e)}},{key:"resetGame",value:function(){this.sprites=[],this.collisionListeners=[]}},{key:"updateModel",value:function(e){Object(M.a)(Object(E.a)(t.prototype),"updateModel",this).call(this,e),this.handleMovement(e)}},{key:"handleMovement",value:function(e){for(var i=e/1e3,t=this.sprites.slice();t.length;){var n=t.pop();if(n.isAlive){if(n.speed){var a={position:P(n.position),size:n.size},o=j(n),s=n.position.x+o.x*i*this.sceneSpeed,r=n.position.y+o.y*i*this.sceneSpeed,l=!1;if(this.wrapAround){var h=this.size.width,c=this.size.height;0!==this.modelSize.width&&(h=this.modelSize.width,c=this.modelSize.height),s<0?(s=h-n.size.width,l=!0):s+n.size.width>h&&(s=0,l=!0),r<0?(r=c-n.size.height,l=!0):r+n.size.height>c&&(r=0,l=!0)}n.priorPosition=a.position,n.position={x:s,y:r};var d={position:P(n.position),size:n.size};l||(d=L(a,d)),n.canCollide&&this._handleCollision(d,n),n.acceleration&&(Math.sign(n.acceleration+n.speed)!==Math.sign(n.speed)?n.speed=0:n.speed=n.speed+n.acceleration)}n.updateModel&&n.updateModel(e),n.isAlive||this.removeSprite(n)}else this.removeSprite(n)}}},{key:"_handleCollision",value:function(e,i){var t;if(i.handleCollision)for(var n=0;n<this.sprites.length;n++){var a=this.sprites[n];if(i!==a&&a.canCollide&&A(e,a)){i.handleCollision(a),t=a;break}}t||(t=i);for(var o=0;o<this.collisionListeners.length;o++){var s=this.collisionListeners[o];if(i!==s&&A(e,s)){s.handleCollision(i),t=s;break}}t.isAlive||this.removeSprite(t)}},{key:"paint",value:function(e,i,n){e={x:e.x+this.viewPort.x,y:e.y+this.viewPort.y},Object(M.a)(Object(E.a)(t.prototype),"paint",this).call(this,e,i,n);var a,o=0,s=Object(S.a)(this.sprites);try{for(s.s();!(a=s.n()).done;){var r=a.value;if(!r.isAlive)throw Error("No Dead Sprites Should Make it to render step.\n"+r);var l=P(r.position);r.isFixedPosition||(l={x:l.x-e.x,y:l.y-e.y}),l.x>this.size.width||l.y>this.size.height||r.size.width+l.x<0||r.size.height+l.y<0||(r.paint(l,i,n),o++)}}catch(h){s.e(h)}finally{s.f()}this.debug&&(++this.count%300===0?(this.totalTime=n,this.count=1):this.totalTime+=n,i.fillText("FPS: ".concat(Math.round(1e3/(this.totalTime/++this.count))," Alive Sprites: ").concat(this.sprites.length," On Screen Sprites: ").concat(o),10,this.size.height-10))}},{key:"addSprites",value:function(e){var i=this;e.forEach((function(e){return i.addSprite(e)}))}}]),t}(O),I=function(){function e(i){Object(y.a)(this,e),this.image=void 0,this.image=i}return Object(w.a)(e,[{key:"init",value:function(e){e.size={width:this.image.width,height:this.image.height}}},{key:"paint",value:function(e,i,t,n){t.drawImage(this.image,i.x,i.y,e.size.width,e.size.height)}}]),e}();function F(e,i,t){return{position:e,size:i,isAlive:!0,paint:function(t,n,a){n.fillStyle="red",n.fillRect(e.x,e.y,i.width,i.height)},handleCollision:function(e){var i=j(e);t?(i.x>0?e.position.x=this.position.x-e.size.width:e.position.x=this.position.x+this.size.width,e.position.y=e.priorPosition.y,e.angle=Math.PI-e.angle+.2*(Math.random()-.5)):(i.y>0?e.position.y=this.position.y-e.size.height:e.position.y=this.position.y+this.size.height,e.position.x=e.priorPosition.x,e.angle=-1*e.angle+.2*(Math.random()-.5))}}}var K=function(e){Object(b.a)(t,e);var i=Object(k.a)(t);function t(){return Object(y.a)(this,t),i.apply(this,arguments)}return Object(w.a)(t,[{key:"preloadImagesKeyPathMap",value:function(){var e=new Map;return e.set("ball","/circles/assets/ball3.png"),e}},{key:"init",value:function(){var e=new R(this);this.scene=e;var i=this.imagePreloader.getImageFromCache("ball"),t=i.width/2;e.handleMouseClick=function(n,a){var o=e.getSpritesAtPoint({x:n,y:a});if(o.length)o.filter((function(e){return e.canCollide})).forEach((function(i){return e.removeSprite(i)}));else{var s=new O({x:n-t,y:a-t});s.isAlive=!0,s.speed=10*Math.random()+100,s.angle=Math.random()*Math.PI*2,s.canCollide=!0,s.addBehavior(new I(i)),e.addSprite(s)}},e.debug=!0,e.wrapAround=!1;var n=e.size;e.addSprite(F({x:0,y:0},{width:n.width-8,height:8},!1)),e.addSprite(F({x:0,y:n.height-8},{width:n.width,height:8},!1)),e.addSprite(F({x:0,y:0},{width:8,height:n.height-8},!0)),e.addSprite(F({x:n.width-8,y:0},{width:8,height:n.height-8},!0))}}]),t}(C),N=Object(c.a)((function(e){return{root:{flexGrow:1},infoButton:{marginRight:e.spacing(1)},controlButton:{},score:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));var T=function(){Object(n.useRef)(null);var e=Object(n.useState)(0),i=Object(h.a)(e,2),t=i[0],o=(i[1],N());return a.a.createElement(a.a.Fragment,null,a.a.createElement(d.a,{position:"static",style:{background:"transparent",boxShadow:"none"}},a.a.createElement(u.a,null,a.a.createElement(p.a,{edge:"start",className:o.infoButton,color:"primary","aria-label":"menu"},a.a.createElement(g.a,null)),a.a.createElement(v.a,{variant:"h6",color:"primary",className:o.title},"Circles"),a.a.createElement(v.a,{variant:"h6",color:"primary",className:o.score},"Score: ",t),a.a.createElement(p.a,{edge:"start",className:o.controlButton,onClick:function(e){e.stopPropagation()},color:"primary","aria-label":"menu"},a.a.createElement(f.a,null)),a.a.createElement(p.a,{edge:"start",className:o.controlButton,onClick:function(e){e.stopPropagation()},color:"primary","aria-label":"menu"},a.a.createElement(m.a,null)))),a.a.createElement(K,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(51);var _=t(37),W=Object(_.a)({overrides:{MuiCssBaseline:{"@global":{body:{width:"100%",height:"100%",margin:"0"}}}}});s.a.render(a.a.createElement(l.a,{theme:W},a.a.createElement(r.a,null),a.a.createElement(T,null)),document.querySelector("#root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[41,1,2]]]);
//# sourceMappingURL=main.e55708c3.chunk.js.map